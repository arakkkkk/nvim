# クリッカー

## 概要

ブラウザのクリックをサポートする Chrome 拡張機能


## 仕様

以下の機能をスタート/ストップで切り替えて利用することができる

* ページの要素をクリックすると、clickアクションが発行される前に、この要素をクリックしますか？のダイアログが表示される。
* ダイアログでOKをクリックすることでクリックイベントが発火される。キャンセルを押すとクリックイベントがキャンセルされる。

## ファイル構成

- `manifest.json`: 拡張機能のマニフェスト（Manifest V3）
- `content.js`: ページ上でクリックを捕捉し、確認ダイアログを表示
- `popup.html` / `popup.js`: スタート/ストップを切り替えるポップアップUI

## 使い方（開発者モード）

1. Chrome の拡張機能管理画面を開く: `chrome://extensions/`
2. 右上の「デベロッパーモード」を ON にする。
3. 「パッケージ化されていない拡張機能を読み込む」をクリックし、このフォルダを選択。
4. 拡張のアイコンをクリックしてポップアップを開き、「OFF/ON」ボタンで切り替える。
   - ON: ページ内のクリック前に「この要素をクリックしますか？」ダイアログを表示します。
   - OFF: 何もしません（通常のクリック動作）。

## Ollama 連携（最小）

- ローカルの Ollama に固定エンドポイント `http://localhost:11434/api/generate`、モデル `llama3.1:8b` で問い合わせます。
- プロンプトは要素のタグ・テキスト・リンク先のみを使うシンプルな一文要約指示です。
- Ollama が起動していない場合は AI 説明は空のままですが、確認ダイアログ自体は表示されます。

## 実装メモ

- クリックはキャプチャ段階で`window.addEventListener('click', handler, true)`として捕捉し、
  キャンセル時は`preventDefault()`と`stopImmediatePropagation()`で伝播と既定動作を止めます。
- `confirm()`は同期ダイアログのため、OKであれば既存のクリック処理へ自然に伝播します。
- ポップアップの状態は`chrome.storage.local.enabled`でグローバルに保持します。
- プログラム的に発火されたクリックは対象外にするため、`e.isTrusted === false`の場合は無視します。

## 既知の注意点

- 一部サイトの独自ショートカットやジェスチャーと競合する場合があります（ON時にのみ発生）。
- iframe 内の要素はデフォルトでは対象外です（必要なら `all_frames` の追加で対応可能）。
